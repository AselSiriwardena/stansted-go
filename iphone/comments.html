<!DOCTYPE html>
<html lang="en">

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Comments</title>

    <!-- jQuery mobile files -->
    <link rel="stylesheet" href="https://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.css"/>
    <script src="https://code.jquery.com/jquery-1.11.1.min.js"></script>
    <script src="https://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.js"></script>


    <!-- Font awesome file -->
    <script src="https://kit.fontawesome.com/f083cf2118.js" crossorigin="anonymous"></script>

    <!-- Bootstrap CSS file -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
          integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

    <!-- Custom JS Files -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>

    <!-- Custom main CSS file -->
    <link rel="stylesheet" href="index.css">

</head>

<body class="post-login">
<div data-role="page" class="reviews">
    <div data-role="header" id="header" class="px-4 pt-5 pb-4">
        <div class="ui-grid-a d-flex align-items-center header-title-back">
            <div class="ui-block-a d-flex align-items-center">
                <a class="ui-btn p-0 m-0 pathUrl" data-transition="slide" accesskey="product_details.html"
                   rel="external">
                    <img alt="back button" height="auto" src="assets/img/back.svg" width="30">
                </a>
                <h3 class="m-0 pl-3">Comments</h3>
            </div>
            <div class="ui-block-b icons">
                <a class="primary-color-black-text" data-rel="popup" href="#overlay" data-position-to="origin"><i
                        class="fas fa-search"></i></a>
                <div class="ui-content" data-shadow="false" data-theme="none" data-overlay-theme="a" data-role="popup"
                     id="overlay">
                    <div class="deals-search-bar">
                        <ul data-role="listview" data-filter="true" data-filter-reveal="true"
                            data-filter-placeholder="Searching Promotions" data-inset="true">
                            <li><a class="dealsClick" accesskey="1">Winter Coffee Sale</a></li>
                            <li><a class="dealsClick" accesskey="2">Google Pixel Sale</a></li>
                            <li><a class="dealsClick" accesskey="3">Furniture Sale</a></li>
                            <li><a class="dealsClick" accesskey="4">Electronic Christmas Sale</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div role="main" class="px-4">
        <div class="my-4 text-center">
        </div>
        <ul class="nav nav-tabs nav-justified nav-primary">
            <li class="nav-item">
                <a href="#latest" class="nav-link active" data-toggle="tab">Latest</a>
            </li>
            <li class="nav-item">
                <a href="#highest" class="nav-link" data-toggle="tab">Highest</a>
            </li>
            <li class="nav-item">
                <a href="#lowest" class="nav-link" data-toggle="tab">Lowest</a>
            </li>
        </ul>
        <div class="tab-content">
            <div class="tab-pane fade show active" id="latest">
                <div id="reviewList"></div>
                <div class="ui-block-b pl-3">
                    <div class="card">
                        <div class="ui-grid-a">
                            <div class="ui-block-b w100 pl-2">
                                <div class="ui-grid-a">
                                    <div class="ui-block-a w40">
                                        <h4 style="line-height: 1.5;" class="black">Nish Ram</h4>
                                    </div>
                                    <div style="color: #E2C224;" class="ui-block-b w60 text-right">
                                        <i class="fas fa-star"></i>
                                        <i class="fas fa-star"></i>
                                        <i class="fas fa-star"></i>
                                        <i class="fas fa-star"></i>
                                        <i class="fas fa-star-half-alt"></i>
                                    </div>
                                </div>
                                <div class="review-content pt-2">
                                    <p style="word-wrap: break-word;" class="primary-color-black text f16">
                                        Great product ! This is
                                        the
                                        best
                                        coffee I've tasted in a while. Definitely recommended if you're a
                                        coffee
                                        lover.</p>
                                </div>
                                <hr class="rounded">
                                <div class="ui-grid-a">
                                    <div class="ui-block-a">
                                        <h6 class="primary-color-grey-text f16 fw-bold">2 Days ago</h6>
                                    </div>
                                    <div class="ui-block-b f16 text-right">
                                        <i class="far fa-heart"></i> 57
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div data-role="collapsible" data-collapsed-icon="carat-d" data-expanded-icon="carat-u">
            <h4>Comments</h4>
            <div id="comments_nish">
            </div>
            <div class=" ui-grid-a pt-2 primary-color-blue-bg">
                <img class="ui-block-a" src="assets/images/reply_profile_1.svg" height="50px">
                <p style="word-wrap: break-word;" class="ui-block-b primary-color-white-text text f16">Comment_1</p>
            </div>
            <div class=" ui-grid-a pt-2 primary-color-white-bg">
                <img class="ui-block-a" src="assets/images/reply_profile_2.svg" height="50px">
                <p style="word-wrap: break-word;" class="ui-block-b primary-color-black-text text f16">Comment_2</p>
            </div>
            <div class=" ui-grid-a pt-2 primary-color-blue-bg">
                <img class="ui-block-a" src="assets/images/reply_profile_1.svg" height="50px">
                <p style="word-wrap: break-word;" class="ui-block-b primary-color-white-text text f16">Comment_3</p>
            </div>
        </div>
        <div class="input-comment-footer">
        <div class="ui-field-contain mt-4">
            <div class="font-size-l font-weight-heavy mb-3">Your Comment</div>
            <textarea type="text" name="feedback" id="feedbackInput"
                      placeholder="Share your comments on reviews..."></textarea>
            <div class="ui-grid-solo text-center sort-apply px-4">
                <div class="ui-block-a w100 mb-3">
                    <a class="ui-btn btn primary-btn m-0" id="submit">POST COMMENT</a>
                </div>
            </div>
        </div>
        </div>
    </div>
</div>
</body>

</html>

<!--<script>-->
<!--    $(document).ready(function () {-->
<!--        $(document).on("click", ".dealsClick", function () {-->
<!--            sessionStorage.setItem("currentDeal", this.accessKey);-->
<!--            sessionStorage.setItem("ratingFilter", '0');-->
<!--            sessionStorage.setItem("priceFilter", '{"startValue":"0","EndValue":"145"}');-->
<!--            sessionStorage.setItem("sort", 'default');-->
<!--            document.location.href = 'promotion_details.html';-->
<!--        });-->
<!--        $(document).on("click", ".pathUrl", function () {-->
<!--            document.location.href = this.accessKey;-->
<!--        });-->
<!--        let reviewList;-->
<!--        changeValue = 'a';-->
<!--        $.post("backend/review.php", {-->
<!--            action: "view",-->
<!--            prodId: sessionStorage.getItem("currentProduct"),-->
<!--        }, function (data, status) {-->
<!--            reviewList = $.parseJSON(data);-->
<!--            $.each(reviewList[0].review, function (i, item) {-->
<!--                let userData;-->
<!--                let imagSrc;-->
<!--                $.post("backend/userData.php", {-->
<!--                    action: 'view',-->
<!--                    currentUser: item.email-->
<!--                }, function (data, status) {-->
<!--                    alert(data);-->
<!--                    userData = JSON.parse(data);-->
<!--                    imagSrc = userData.imageSrc;-->
<!--                    const ratings = item.rating;-->
<!--                    const ratingInt = parseInt(ratings);-->
<!--                    let ratingHtml = "";-->
<!--                    for (let i = 0; i < 5; i++) {-->
<!--                        if (ratingInt > i) {-->
<!--                            ratingHtml = ratingHtml + `<i class="fas fa-star secondary-color-yellow-text"></i>`;-->
<!--                        } else {-->
<!--                            ratingHtml = ratingHtml + `<i class="fas fa-star primary-color-grey-text"></i>`;-->
<!--                        }-->
<!--                    }-->

<!--                    const review = `<div class="ui-block-` + changeValue + ` w100 w-landscape-50"><div class="comment card px-3">-->
<!--                        <div class="ui-grid-a">-->
<!--                            <div class="ui-block-a w20">-->
<!--                                <img src="` + userData.imageSrc + `" id="previewImage" alt="Profile Avatar" width="75%">-->
<!--                            </div>-->
<!--                            <div class="ui-block-b w80">-->
<!--                                <div class="ui-grid-a d-flex align-items-baseline">-->
<!--                                    <div class="ui-block-a">-->
<!--                                        <h4 class="black line-height-small font-weight-bold">` + userData.name + `</h4>-->
<!--                                    </div>-->
<!--                                    <div class="ui-block-b text-right secondary-color-yellow-text">-->
<!--                                        ` + ratingHtml + `-->
<!--                                    </div>-->
<!--                                </div>-->
<!--                                <div class="review-content pt-3">-->
<!--                                    <p>-->
<!--                                        ` + item.description + `-->
<!--                                    </p>-->
<!--                                </div>-->
<!--                                <div class="ui-grid-a d-flex align-items-center">-->
<!--                                    <div class="ui-block-a">-->
<!--                                        <h6 class="text-muted mb-0 font-weight-bold">` + item.time + `</h6>-->
<!--                                    </div>-->
<!--                                    <div class="ui-block-b text-right">-->
<!--                                        <i class="far fa-heart icon"></i>-->
<!--                                        <span class = "font-weight-heavy font-size-m pl-2 v-align-top">57</span>-->
<!--                                    </div>-->
<!--                                </div>-->
<!--                            </div>-->
<!--                        </div>-->
<!--                    </div>`;-->
<!--                    $("#reviewList").append(review);-->
<!--                    if (changeValue === 'a') {-->
<!--                        changeValue = 'b';-->

<!--                    } else if (changeValue === 'b') {-->
<!--                        changeValue = 'a';-->
<!--                    }-->
<!--                });-->
<!--            });-->
<!--        });-->
<!--    });-->
<!--</script>-->
<script src="https://www.gstatic.com/firebasejs/7.2.3/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/7.2.3/firebase-firestore.js"></script>
<script>
    var config = {
        apiKey: "AIzaSyDC0db7ssF55Q-yfiGUeCqB8wtHZ4_tyZw",
        authDomain: "ui-ux-b3439.firebaseapp.com",
        projectId: "ui-ux-b3439",
        storageBucket: "ui-ux-b3439.appspot.com",
        messagingSenderId: "628403705685",
        appId: "1:628403705685:web:bebfe39d9d923bbf74c1dc",
        measurementId: "G-CMKJ405F25"
    };
    // Initialize Firebase
    var app = firebase.initializeApp(config);
    // Initialize Cloud Firestore through Firebase
    const db = app.firestore();
    const docRef = db.collection("Places").doc('place_id_01').collection('comments');

    let i = 0;
    db.collection("Places").doc('place_id_01').collection('comments').get().then((snapshot) => {
        snapshot.forEach(function(x) {
            $("#comments_nish").append(`
        <div class=" ui-grid-a pt-2 primary-color-blue-bg">
                <img class="ui-block-a" src="assets/images/reply_profile_1.svg" height="50px">
                <p style="word-wrap: break-word;" class="ui-block-b primary-color-white-text text f16">${x.data().comment}</p>
            </div>
        `)
        })
    })
    $("#submit").click(function () {
        console.log($("#feedbackInput").val())
        docRef.add({
            comment : $("#feedbackInput").val()

        })
            .then(function(docRef) {
                console.log("Document written with ID: ", docRef.id);
                // document.location.href = 'reviews.html';
            })
            .catch(function(error) {
                console.error("Error adding document: ", error);
            });
        // $.post("backend/review.php", {
        //     action: "add",
        //     email: sessionStorage.getItem("loggedUser"),
        //     prodId: sessionStorage.getItem("currentProduct"),
        //     description: $("#feedback").val(),
        //     time: '2 days ago',
        //     rating: $('#ratedVal').val(),
        // }, function (data, status) {
        //     if (data === 'error') {
        //         alert('Error');
        //     } else if (data === 'success') {
        //         document.location.href = 'reviews.html';
        //     } else {
        //
        //     }
        // });
    });

    db.collection("Places").doc('place_id_01').collection('Ratings').get().then((snapshot) => {
        snapshot.forEach(function(x) {
            // $("#test1").append(`
            //                 ${!Boolean(i % 2) ? `<div class="ui-block-a w50 pl-3">` : `<div class="ui-block-b w50 pl-3">`}
            //                 <div class="ui-block-a pl-3">
            //                     <div class="card">
            //                         <div class="ui-grid-a">
            //                             <div class="ui-block-b w80 pl-2">
            //                                 <div class="ui-grid-a">
            //                                     <div class="ui-block-a w40">
            //                                         <h4 style="line-height: 1.5;" class="black">${x.data().name?x.data().name:"Jane Doe"}</h4>
            //                                     </div>
            //                                     <div style="color: #E2C224;" class="ui-block-b w60 text-right">
            //                                             ${x.data().rating === '4' ? `
            //                                             <i class="fa fa-star secondary-color-yellow-text"></i>
            //                                             <i class="fa fa-star secondary-color-yellow-text"></i>
            //                                             <i class="fa fa-star secondary-color-yellow-text"></i>
            //                                             <i class="fa fa-star secondary-color-yellow-text"></i>
            //                                             <i class="fa fa-star-o secondary-color-yellow-text"></i>`
            //     : x.data().rating === '5' ?`<i class="fa fa-star secondary-color-yellow-text"></i>
            //                                             <i class="fa fa-star secondary-color-yellow-text"></i>
            //                                             <i class="fa fa-star secondary-color-yellow-text"></i>
            //                                             <i class="fa fa-star secondary-color-yellow-text"></i>
            //                                             <i class="fa fa-star secondary-color-yellow-text"></i>`
            //         : x.data().rating === '3' ? `<i class="fa fa-star secondary-color-yellow-text"></i>
            //                                             <i class="fa fa-star secondary-color-yellow-text"></i>
            //                                             <i class="fa fa-star secondary-color-yellow-text"></i>
            //                                             <i class="fa fa-star-o secondary-color-yellow-text"></i>
            //                                             <i class="fa fa-star-o secondary-color-yellow-text"></i>`
            //             : x.data().rating === '2' ? `<i class="fa fa-star secondary-color-yellow-text"></i>
            //                                             <i class="fa fa-star secondary-color-yellow-text"></i>
            //                                             <i class="fa fa-star-o secondary-color-yellow-text"></i>
            //                                             <i class="fa fa-star-o secondary-color-yellow-text"></i>
            //                                             <i class="fa fa-star-o secondary-color-yellow-text"></i>`
            //                 : x.data().rating === '1' ? `<i class="fa fa-star secondary-color-yellow-text"></i>
            //                                             <i class="fa fa-star-o secondary-color-yellow-text"></i>
            //                                             <i class="fa fa-star-o secondary-color-yellow-text"></i>
            //                                             <i class="fa fa-star-o secondary-color-yellow-text"></i>
            //                                             <i class="fa fa-star-o secondary-color-yellow-text"></i>`
            //                     : `<i class="fa fa-star secondary-color-yellow-text"></i>
            //                                             <i class="fa fa-star secondary-color-yellow-text"></i>
            //                                             <i class="fa fa-star secondary-color-yellow-text"></i>
            //                                             <i class="fa fa-star secondary-color-yellow-text"></i>
            //                                             <i class="fa fa-star secondary-color-yellow-text"></i>
            //                                         `}
            //
            //                                     </div>
            //                                 </div>
            //                                 <div class="review-content pt-2">
            //                                     <p style="word-wrap: break-word;" class="primary-color-black text f16">
            //                                         ${x.data().description}</p>
            //                                 </div>
            //                                 <div class="ui-grid-a">
            //                                     <div class="ui-block-a">
            //                                         <h6 class="primary-color-grey-text f16 fw-bold">${x.data().time}</h6>
            //                                     </div>
            //                                     <div class="ui-block-b f16 text-right">
            //                                         <i class="far fa-heart"></i> 0
            //                                     </div>
            //                                 </div>
            //                             </div>
            //                         </div>
            //                     </div>
            //                 </div>
            //     `);
            i = i + 1;
        });
    });


</script>
